const aboutContactsButtonElement=document.querySelector(`.about-contacts-button`),writeUsElement=document.querySelector(`.write-us`),writeUsForm=document.querySelector(`.write-us-form`),mapPreviewElement=document.querySelector(`.map-preview`),contactsMapElement=document.querySelector(`.contacts-map`),serviceItemElements=document.querySelectorAll(`.service-item`),serviceSliderItemElements=document.querySelectorAll(`.service-slider-item`),promoSliderItemElements=document.querySelectorAll(`.promo-slider-item`),sliderButtonBackElement=document.querySelector(`.slider-button-back`),sliderButtonNextElement=document.querySelector(`.slider-button-next`),sliderControlsForm=document.querySelector(`.slider-controls`),basketInfoElement=document.querySelector(`.basket-info`),basketInfoProceedElement=document.querySelector(`.basket-info-proceed`);let isStorageSupport=!0,storage={};try{storage.name=localStorage.getItem(`name`),storage.email=localStorage.getItem(`email`)}catch(a){isStorageSupport=!1}let onPopupCloseClick=a=>{a.preventDefault();let b=a.target.closest(`.popup`);b.classList.remove(`modal-show`),a.target.removeEventListener(`click`,onPopupCloseClick)},findPopupCloseElement=a=>a.querySelector(`.popup-close`),focusForm=()=>{const a=writeUsElement.querySelector(`#email`),b=writeUsElement.querySelector(`#name`),c=writeUsElement.querySelector(`#message`);if(storage.name)b.value=storage.name;else return void b.focus();storage.email?(a.value=storage.email,c.focus()):a.focus()},onAboutContactsButtonElementClick=a=>{a.preventDefault(),writeUsElement.classList.add(`modal-show`),focusForm();let b=findPopupCloseElement(writeUsElement);b.addEventListener(`click`,onPopupCloseClick),b.addEventListener(`click`,onPopupCloseClick)},onMapPreviewElementClick=a=>{a.preventDefault(),contactsMapElement.classList.add(`modal-show`);let b=findPopupCloseElement(contactsMapElement);b.addEventListener(`click`,onPopupCloseClick),b.addEventListener(`click`,onPopupCloseClick)},onWriteUsFormSubmit=()=>{emailElement.value&&localStorage.setItem(`email`,emailElement.value),nameElement.value&&localStorage.setItem(`name`,nameElement.value)},onDocumentKeyDown=a=>{27===a.keyCode&&(writeUsElement&&writeUsElement.classList.remove(`modal-show`),contactsMapElement&&contactsMapElement.classList.remove(`modal-show`),basketInfoElement&&basketInfoElement.classList.remove(`modal-show`),a.preventDefault())},onServiceItemButtonClick=a=>b=>{b.preventDefault();let c=b.target.closest(`.service-item`);c.classList.contains(`service-item-active`)||(Array.from(serviceItemElements).forEach(a=>{a.classList.remove(`service-item-active`)}),c.classList.add(`service-item-active`),Array.from(serviceSliderItemElements).forEach(b=>{b.classList.contains(a)?b.classList.remove(`hidden`):b.classList.add(`hidden`)}))},addServiceSliderHandlers=()=>{Array.from(serviceItemElements).forEach(a=>{let b=a.dataset.slide;a.addEventListener(`click`,onServiceItemButtonClick(b))})},flipThoughPromoSliders=(a,b)=>{for(let c in a.preventDefault(),promoSliderItemElements){if(promoSliderItemElements[c].classList.contains(`hidden`))continue;promoSliderItemElements[c].classList.add(`hidden`);let a=b(c);promoSliderItemElements[a].classList.remove(`hidden`);let d=promoSliderItemElements[a].dataset.slide,e=sliderControlsForm.querySelector(`#${d}`);e.checked=!0;break}},onSliderButtonNextElementClick=a=>{flipThoughPromoSliders(a,a=>+a==promoSliderItemElements.length-1?0:+a+1)},onSliderButtonBackElementClick=a=>{flipThoughPromoSliders(a,a=>0==+a?promoSliderItemElements.length-1:0)},onSliderFormChange=a=>{a.preventDefault();let b=a.target;b.classList.contains(`slider-controls-input`)&&Array.from(promoSliderItemElements).forEach(a=>{a.dataset.slide===b.id?a.classList.remove(`hidden`):a.classList.add(`hidden`)})},addPromoSliderHandlers=()=>{sliderButtonNextElement.addEventListener(`click`,onSliderButtonNextElementClick),sliderButtonBackElement.addEventListener(`click`,onSliderButtonBackElementClick),sliderControlsForm.addEventListener(`change`,onSliderFormChange)},onGoodBuyElementClick=a=>{let b=a.target.closest(`.good-buy`);if(b&&a.target.classList.contains(`good-buy`)){a.preventDefault(),basketInfoElement.classList.add(`modal-show`);let b=findPopupCloseElement(basketInfoElement);b.addEventListener(`click`,onPopupCloseClick),b.addEventListener(`click`,onPopupCloseClick)}},onBasketInfoProceedElementClick=a=>{a.preventDefault(),basketInfoElement.classList.remove(`modal-show`)},addHandlers=()=>{aboutContactsButtonElement&&aboutContactsButtonElement.addEventListener(`click`,onAboutContactsButtonElementClick),writeUsForm&&writeUsForm.addEventListener(`submit`,onWriteUsFormSubmit),mapPreviewElement&&mapPreviewElement.addEventListener(`click`,onMapPreviewElementClick),document.addEventListener(`keydown`,onDocumentKeyDown),sliderControlsForm&&(addServiceSliderHandlers(),addPromoSliderHandlers()),document.addEventListener(`click`,onGoodBuyElementClick),basketInfoProceedElement&&basketInfoProceedElement.addEventListener(`click`,onBasketInfoProceedElementClick)};addHandlers();
